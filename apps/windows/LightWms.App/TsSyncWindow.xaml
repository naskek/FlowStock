<Window x:Class="LightWms.App.TsSyncWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Синхронизация с ТСД"
        Height="640" Width="980"
        WindowStartupLocation="CenterOwner">
    <Grid Margin="12">
        <TabControl>
            <TabItem Header="Выгрузить данные на ТСД">
                <StackPanel Margin="8">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="Папка ТСД:" VerticalAlignment="Center" />
                        <TextBlock x:Name="TsdFolderText" Margin="8,0,12,0" Foreground="Gray"
                                   VerticalAlignment="Center" TextWrapping="Wrap" Width="600" />
                        <Button Content="Выбрать..." Click="SelectFolder_Click" Width="120" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="Устройство:" VerticalAlignment="Center" />
                        <ComboBox x:Name="TsdDeviceCombo" Width="260" Margin="8,0,0,0"
                                  DisplayMemberPath="DisplayName" />
                    </StackPanel>
                    <TextBlock Text="Файл данных: LightWMS_TSD_DATA.json" Foreground="Gray" Margin="0,0,0,12" />
                    <Button Content="Выгрузить данные..." Width="180" Click="ExportData_Click" />
                    <TextBlock x:Name="ExportSummaryText" Margin="0,12,0,0" TextWrapping="Wrap" />
                </StackPanel>
            </TabItem>
            <TabItem Header="Загрузить операции с ТСД">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
                        <TextBlock Text="Папка ТСД:" VerticalAlignment="Center" />
                        <TextBlock x:Name="TsdFolderTextImport" Margin="8,0,12,0" Foreground="Gray"
                                   VerticalAlignment="Center" TextWrapping="Wrap" Width="600" />
                        <Button Content="Выбрать..." Click="SelectFolder_Click" Width="120" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,8">
                        <Button Content="Выбрать файлы операций..." Click="SelectFiles_Click" Width="220" />
                        <Button x:Name="ImportFromFolderButton" Content="Импортировать из папки ТСД"
                                Click="ImportFromFolder_Click" Width="240" Margin="8,0,0,0" />
                    </StackPanel>
                    <TextBlock x:Name="SelectedFilesText" Grid.Row="2" Foreground="Gray" TextWrapping="Wrap" />
                    <DataGrid x:Name="ImportLogGrid" Grid.Row="3" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Файл" Binding="{Binding FileName}" Width="*" />
                            <DataGridTextColumn Header="Устройство" Binding="{Binding DeviceDisplay}" Width="140">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding DeviceTooltip}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Товары" Binding="{Binding ItemsUpserted}" Width="90" />
                            <DataGridTextColumn Header="Операции" Binding="{Binding OperationsImported}" Width="110" />
                            <DataGridTextColumn Header="Документы" Binding="{Binding Documents}" Width="120" />
                            <DataGridTextColumn Header="Строки" Binding="{Binding Lines}" Width="120" />
                            <DataGridTextColumn Header="Импортировано" Binding="{Binding Imported}" Width="140" />
                            <DataGridTextColumn Header="Дубли" Binding="{Binding Duplicates}" Width="120" />
                            <DataGridTextColumn Header="Ошибки" Binding="{Binding Errors}" Width="120" />
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Orientation="Horizontal" Grid.Row="4" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <Button Content="Ошибки импорта" Click="OpenImportErrors_Click" Width="160" Margin="0,0,8,0" />
                        <Button Content="Сохранить отчет" Click="SaveReport_Click" Width="160" />
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
